{{ partial "header.html" . }}

<div class="markdown">{{partial "content.html" . }}</div>

<div id="featuredprojects" class="featured">
<h2>Featured projects</h2>
{{ range $i, $p := .Site.Pages }}
{{ if eq .Type "project" }}
{{ if not (eq .RelPermalink "/project/") }}
{{ if .Params.params.featured }}
{{$self := .}}
{{with .Params.params.image}}
<a href="{{$self.Permalink}}"><img src="{{$self.Permalink}}{{.}}"></a>
{{end}}
{{ end }}
{{ end }}
{{ end }}
{{ end }}
</div>

<div id="latestdevlog" class="featured">
<h2>Latest devlog</h2>
{{ if isset .Site.Params "latestdevlogcount" }}
    <div class="posts">
    {{ $all_posts := where .Site.Pages "Section" "devlog" }}
    {{ $posts := where $all_posts "RelPermalink" "!=" "/devlog/" }}
    {{ $postcount := len $posts }}
    {{ if gt $postcount 0 }}
        <div class="page-heading">Latest posts</div>
        <ul>
        {{ range (first .Site.Params.latestdevlogcount $posts).GroupByDate "Jan, 2006" "desc" }}
            <li class="groupby">{{ .Key }}</li>
            {{ range .Pages.ByPublishDate }}
                {{ partial "post-preview.html" . }}
            {{ end }}
        {{ end }}
        </ul>

        {{ if gt $postcount .Site.Params.latestdevlogcount }}
            <a href="./devlog/" class="see-more">See more ...</a>
        {{ end }}
    {{ end }}
    </div>
{{ end }}
</div>

<div id="latestblog" class="featured">
<h2>Latest blog</h2>
{{ if isset .Site.Params "latestpostcount" }}
    <div class="posts">
    {{ $all_posts := where .Site.Pages "Section" "blog" }}
    {{ $posts := where $all_posts "RelPermalink" "!=" "/blog/" }}
    {{ $postcount := len $posts }}
    {{ if gt $postcount 0 }}
        <div class="page-heading">Latest posts</div>
        <ul>
        {{ range (first .Site.Params.latestpostcount $posts).GroupByDate "Jan, 2006" "desc" }}
            <li class="groupby">{{ .Key }}</li>
            {{ range .Pages.ByPublishDate }}
                {{ partial "post-preview.html" . }}
            {{ end }}
        {{ end }}
        </ul>

        {{ if gt $postcount .Site.Params.latestpostcount }}
            <a href="./blog/" class="see-more">See more ...</a>
        {{ end }}
    {{ end }}
    </div>
{{ end }}
</div>


{{ partial "footer.html" . }}
